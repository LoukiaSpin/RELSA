f_name  <- paste("Svenja Tier 98",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1000, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset      <- relsa_plot(testset, levels=levels, RELSA, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2), mypch=15, mycol="black", myXlab="day")
legend("topleft", c("1% DSS + BS (bwc/vwr"), pch=c(15), lty=c(1 ), col=c("black"), bty="n")
dev.off()
# show raw data + RELSA
f_name  <- paste("Svenja Tier 98",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1000, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset      <- relsa_plot(testset, levels=levels, RELSA, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2), mypch=15, mycol="black", myXlab="day")
legend("topleft", c("1% DSS + BS (bwc/vwr)"), pch=c(15), lty=c(1 ), col=c("black"), bty="n")
dev.off()
# show raw data + RELSA
f_name  <- paste("Svenja Tier 98",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1000, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset      <- relsa_plot(testset, levels=levels, RELSA, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,4), mypch=15, mycol="black", myXlab="day")
legend("topleft", c("1% DSS + BS (bwc/vwr)"), pch=c(15), lty=c(1 ), col=c("black"), bty="n")
dev.off()
source('C:/MHH Bleich/Papers/PostOPPaper/Relsa package/RELSA/R/relsa_plot.R', echo=TRUE)
source('C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/Paper R Scripts/Paper RELSA cases.R', echo=TRUE)
library(RELSA)
raw          <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt", treatment = "Transmitter" )
vars         <- c("bwc", "bur2h","burON","hr","hrv", "temp", "act", "mgs")
turnvars     <- c("hr", "mgs", "temp" )
org          <- cbind(raw[,1:4], raw[,vars])
pre          <- relsa_norm(org,   normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
bsl          <- relsa_baselines(dataset=pre, bslday=-1, variables=vars, turnvars=turnvars)
levels       <- relsa_levels(pre, mypath="C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/Clusters/", bsl,
filename="Burrowing levels", drops=c("bw","score"), turns=c("hr","mgs","temp"), relsaNA=NA, k=4,
showScree="no", customCol= c("red","green","blue","magenta"), seed=123, myYlim=c(0,1.4),
saveTiff="yes")
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 1
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
RELSA
animal       <- 2
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
RELSA
animal       <- 3
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
RELSA
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 3
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
animal       <- 4
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 4
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 5
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 6
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 7
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 8
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 9
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 10
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 11
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 12
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
animal       <- 12
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
RELSA
testset[testset$id==unique(testset$id)[animal],]
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 3
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 4
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
RELSA
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 4
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
animal       <- 4
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
#########################################################################################################################
########## Wheel running approach
#########################################################################################################################
raw          <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laufrad.txt" )
vars         <- c("bwc","hr", "hrv", "act", "rotdark" ) #, "rot20", "vmax"
turnvars     <- c("hr" )
org          <- cbind(raw[,1:4], raw[,vars])
pre          <- relsa_norm(org,  normthese=c("hr", "hrv", "act", "rotdark" ), ontime=1)
bsl          <- relsa_baselines(dataset=pre, bslday=-1, variables=vars, turnvars=turnvars)
levels       <- relsa_levels(pre, mypath="C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/Clusters/", bsl,
filename="RW levels", drops=NULL, turns="hr", relsaNA=NA, k=4,
showScree="no", customCol= c("green","magenta","blue","red"), seed=123, myYlim=c(0,1.4),
saveTiff="yes")
##### Laura Laufrad Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laufrad.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("hr", "hrv", "act", "rotdark" ), ontime=1)
animal        <- 13# 8
RELSA         <- relsa(testset, bsl, a=animal, drop=c("bw","score","vmax","rr","rot20"),
turnvars=NULL, relsaNA=NA)
testset[testset$id==unique(testset$id)[animal],]
RELSA
library(RELSA)
raw          <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt", treatment = "Transmitter" )
vars         <- c("bwc", "bur2h","burON","hr","hrv", "temp", "act", "mgs")
turnvars     <- c("hr", "mgs", "temp" )
org          <- cbind(raw[,1:4], raw[,vars])
pre          <- relsa_norm(org,   normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
bsl          <- relsa_baselines(dataset=pre, bslday=-1, variables=vars, turnvars=turnvars)
levels       <- relsa_levels(pre, mypath="C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/Clusters/", bsl,
filename="Burrowing levels", drops=c("bw","score"), turns=c("hr","mgs","temp"), relsaNA=NA, k=4,
showScree="no", customCol= c("red","green","blue","magenta"), seed=123, myYlim=c(0,1.4),
saveTiff="yes")
##### Laura Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bur2h","burON","hr","hrv", "temp", "act", "mgs" ), ontime=1)
animal       <- 4
RELSA        <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
animal       <- 15
RELSA2       <- relsa(set=testset, bsl, a=animal, drop=c("bw","score","mgs30","mgs180" ), turnvars=c("hr", "mgs","temp" ), relsaNA=NA)
relsascore2  <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA TM vs Sham carp",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("TM/Carprofen","Sham/Carprofen"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Marcin Model Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/marcin_clp.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bwc","temp"), ontime=2)
animal       <- 19 #19 is good paper showcase
RELSA        <- relsa(testset, bsl, a=animal, drop=NULL, turnvars="temp")
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
# show raw data + RELSA
f_name  <- paste("Marcin CLP",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1000, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset      <- relsa_plot(testset, levels=levels, RELSA, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,4), mypch=15, mycol="black", myXlab="day")
legend("topleft", c("CLP (bwc/temp)"), pch=c(15), lty=c(1 ), col=c("black"), bty="n")
dev.off()
RELSA
#########################################################################################################################
########## Wheel running approach
#########################################################################################################################
raw          <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laufrad.txt" )
vars         <- c("bwc","hr", "hrv", "act", "rotdark" ) #, "rot20", "vmax"
turnvars     <- c("hr" )
org          <- cbind(raw[,1:4], raw[,vars])
pre          <- relsa_norm(org,  normthese=c("hr", "hrv", "act", "rotdark" ), ontime=1)
bsl          <- relsa_baselines(dataset=pre, bslday=-1, variables=vars, turnvars=turnvars)
levels       <- relsa_levels(pre, mypath="C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/Clusters/", bsl,
filename="RW levels", drops=NULL, turns="hr", relsaNA=NA, k=4,
showScree="no", customCol= c("green","magenta","blue","red"), seed=123, myYlim=c(0,1.4),
saveTiff="yes")
##### Laura Laufrad Single Tests #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laufrad.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("hr", "hrv", "act", "rotdark" ), ontime=1)
animal        <- 13# 8
RELSA         <- relsa(testset, bsl, a=animal, drop=c("bw","score","vmax","rr","rot20"),
turnvars=NULL, relsaNA=NA)
testset[testset$id==unique(testset$id)[animal],]
animal        <- 21
RELSA2        <- relsa(testset, bsl, a=animal, drop=c("bw","score","vmax","rr","rot20"),
turnvars=NULL, relsaNA=NA)
relsascore2   <- as.numeric(unlist(RELSA2$relsa$rms))
testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("RELSA WR TM vs Sham meta",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1500, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset       <- relsa_plot(pre_test, RELSA, levels=levels, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(80,120), myYlim=c(0,1.4), mypch=19, myXlab="day")
lines(c(-1:28), relsascore2, type="b", pch=17 )
text(26,levels$level1+0.06, levels$level1 )
text(26,levels$level2+0.06, levels$level2 )
text(26,levels$level3+0.06, levels$level3 )
text(26,levels$level4+0.06, levels$level4 )
legend("topright", c("RW TM/Metamizol","RW Sham/Metamizol"), pch=c(19,17), lty=c(1,1), col=c("red","black"), bty="n")
dev.off()
##### Svenja DSS #########################################
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/svenja_dss_mod.txt" )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("bwc", "rotdark", "vmax"), ontime=1)
animal       <- 98
RELSA        <- relsa(set=testset, bsl, a=animal, drop="vmax", turnvars=NULL, relsaNA=NA)
relsascore   <- as.numeric(unlist(RELSA$relsa$rms))
tier         <- testset[testset$id==unique(testset$id)[animal],]
# show raw data + RELSA
f_name  <- paste("Svenja Tier 98",".tiff",sep="")
mypath  <- paste("C:/MHH Bleich/Papers/PostOPPaper/Relsa package/paper figures/", f_name,sep="")
tiff(file = mypath, width = 1000, height = 1000, units = "px", pointsize = 6,res = 400, compression = "lzw")
plotset      <- relsa_plot(testset, levels=levels, RELSA, animal=animal, plotvar=NULL,
plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,4), mypch=15, mycol="black", myXlab="day")
legend("topleft", c("1% DSS + BS (bwc/vwr)"), pch=c(15), lty=c(1 ), col=c("black"), bty="n")
dev.off()
RELSA
