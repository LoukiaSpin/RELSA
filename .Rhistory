for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
library(RELSA)
raw          <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt", treatment = "Transmitter" )
dat          <- raw[,c("day", "bwc","score","mgs","bur2h","burON","hr","hrv","temp","act")]
head(dat)
# highlight data by op day
postop       <- dat[dat$day=="0",]
plot(dat$hrv, dat$hr)
points(postop$hrv, postop$hr, pch=19, col="red")
# k-means
set.seed(123)
rawset       <- dat[,c("day","hrv", "hr")]
rawset       <- rawset[complete.cases(rawset), ]
set          <- scale(rawset[,-1])
mydata <- set
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
cl           <- as.numeric(kmeans(set,3)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="5",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
nts(postop$hrv, postop$hr, pch=19, col="red")
# k-means
set.seed(123)
rawset       <- dat[,c("day","hrv", "hr")]
rawset       <- rawset[complete.cases(rawset), ]
set          <- scale(rawset[,-1])
mydata <- set
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
# k-means
set.seed(123)
rawset       <- dat[,c("day","hrv", "hr")]
rawset       <- rawset[complete.cases(rawset), ]
set          <- scale(rawset[,-1])
mydata <- set
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="blue")
ora   <- sum(postop$color=="red")
blu   <- sum(postop$color=="green")
gre   <- sum(postop$color=="orange")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
# highlight data by op day
postop       <- dat[dat$day=="0",]
plot(dat$hrv, dat$hr)
points(postop$hrv, postop$hr, pch=19, col="red")
# k-means
rawset       <- dat[,c("day","hrv", "hr")]
rawset       <- rawset[complete.cases(rawset), ]
set          <- scale(rawset[,-1])
mydata <- set
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "blue"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="blue")
ora   <- sum(postop$color=="red")
blu   <- sum(postop$color=="green")
gre   <- sum(postop$color=="orange")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "red"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="blue")
ora   <- sum(postop$color=="red")
blu   <- sum(postop$color=="green")
gre   <- sum(postop$color=="orange")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "green"
rawset$color[cl==2]<- "orange"
rawset$color[cl==3]<- "red"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="blue")
ora   <- sum(postop$color=="red")
blu   <- sum(postop$color=="green")
gre   <- sum(postop$color=="orange")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
# k-means
rawset       <- dat[,c("day","hrv", "hr")]
rawset       <- rawset[complete.cases(rawset), ]
set          <- scale(rawset[,-1])
mydata <- set
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "orange"
rawset$color[cl==2]<- "red"
rawset$color[cl==3]<- "blue"
rawset$color[cl==4]<- "green"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="blue")
ora   <- sum(postop$color=="red")
blu   <- sum(postop$color=="green")
gre   <- sum(postop$color=="orange")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "green"
rawset$color[cl==2]<- "red"
rawset$color[cl==3]<- "blue"
rawset$color[cl==4]<- "orange"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="blue")
ora   <- sum(postop$color=="red")
blu   <- sum(postop$color=="green")
gre   <- sum(postop$color=="orange")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
library(RELSA)
raw          <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op laura.txt", treatment = "Transmitter" )
dat          <- raw[,c("day", "bwc","score","mgs","bur2h","burON","hr","hrv","temp","act")]
head(dat)
# highlight data by op day
postop       <- dat[dat$day=="0",]
plot(dat$hrv, dat$hr)
points(postop$hrv, postop$hr, pch=19, col="red")
# k-means
rawset       <- dat[,c("day","hrv", "hr")]
rawset       <- rawset[complete.cases(rawset), ]
set          <- scale(rawset[,-1])
mydata <- set
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
set.seed(123)
cl           <- as.numeric(kmeans(set,4)$cluster)
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "green"
rawset$color[cl==2]<- "red"
rawset$color[cl==3]<- "blue"
rawset$color[cl==4]<- "orange"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="blue")
ora   <- sum(postop$color=="red")
blu   <- sum(postop$color=="green")
gre   <- sum(postop$color=="orange")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
# highlight in clusters
rawset$cl    <- cl
rawset$color[cl==1]<- "green"
rawset$color[cl==2]<- "red"
rawset$color[cl==3]<- "blue"
rawset$color[cl==4]<- "orange"
daylist  <- c(-1,0,1,2,3,4,5,7,14)
fracs    <- NULL
for(i in 1:length(daylist)){
postop       <- rawset[rawset$day==daylist[i],]
# eval
red   <- sum(postop$color=="red")
ora   <- sum(postop$color=="orange")
blu   <- sum(postop$color=="blue")
gre   <- sum(postop$color=="green")
sums  <- data.frame(red=red, orange=ora, blue=blu, green=gre)
fracs <- rbind(fracs, sums)
}
rownames(frac)<-daylist
fracs
#highlight single days
plot(rawset$hrv, rawset$hr, pch=19, col=rawset$color)
postop       <- rawset[rawset$day=="-1",]
points(postop$hrv, postop$hr, pch=4, cex=2, lwd=2, col="magenta")
# EM clustering -----------------------------------------------------------
library(mclust)
