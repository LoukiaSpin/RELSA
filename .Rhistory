abline(h=levels$level3, lwd=2, lty=2)
abline(h=levels$level4, lwd=2, lty=2)
text(100,levels$level1+0.1, levels$level1 )
text(100,levels$level2+0.1, levels$level2 )
text(100,levels$level3+0.1, levels$level3 )
text(100,levels$level4+0.1, levels$level4 )
abline(v=36.5, lwd=1, lty=3)
lines(1:length(unique(tm$id)), mean(tm$rms, na.rm=TRUE), col="red", lwd=2)
length(unique(tm$id))
mean(tm$rms, na.rm=TRUE)
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
lines(length(unique(tm$id)) + length(unique(sh$id)), rep(mean(sh$rms, na.rm=TRUE),length(unique(sh$id))), col="green", lwd=2)
length(unique(tm$id)) + length(unique(sh$id))
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
lines(length(unique(tm$id)) : length(unique(sh$id)), rep(mean(sh$rms, na.rm=TRUE),length(unique(sh$id))), col="green", lwd=2)
length(unique(tm$id)) : length(unique(sh$id))
length(length(unique(tm$id)) : length(unique(sh$id)))
rep(mean(sh$rms, na.rm=TRUE),length(unique(sh$id)))
mean(sh$rms, na.rm=TRUE)
length(unique(tm$id))
length(unique(sh$id))
length(unique(sh$id))
unique(sh$id))
unique(sh$id)
# Plot all ----------------------------------------------------------------
plot(rep(1,length(df[df$id==unique(df$id)[1], "rms"])), df[df$id==unique(df$id)[1], "rms"],
xlim=c(0, length(unique(df$id))), ylim=c(0,1.4),
col= unique(mycolors[ df$id==unique(df$id)[1]]),
pch= unique(mypch[ df$id==unique(df$id)[1]])   , ylab="RELSA score", xlab="Animal index",
bg = "black", cex=1)
for(i in 2:length(unique(df$id))){
points( rep(i,length(df[df$id==unique(df$id)[i], "rms"])), df[df$id==unique(df$id)[i], "rms"],
col= unique(mycolors[ df$id==unique(df$id)[i]]),
pch= unique(mypch[ df$id==unique(df$id)[i]]),
bg = "black", cex=ifelse(unique(mypch[ df$id==unique(df$id)[i]])==18,1.7,1))
}
abline(h=levels$level1, lwd=2, lty=2)
abline(h=levels$level2, lwd=2, lty=2)
abline(h=levels$level3, lwd=2, lty=2)
abline(h=levels$level4, lwd=2, lty=2)
text(100,levels$level1+0.1, levels$level1 )
text(100,levels$level2+0.1, levels$level2 )
text(100,levels$level3+0.1, levels$level3 )
text(100,levels$level4+0.1, levels$level4 )
abline(v=36.5, lwd=1, lty=3)
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
lines(0:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
length(unique(tm$id)
)
length(length(unique(tm$id)+1)
length(length(unique(tm$id)+1)
length(length(unique(tm$id)+1
length(unique(tm$id)+1
length(unique(tm$id))+1
unique(sh$id)
length(  length(unique(tm$id))+1  : length(unique(tm$id))+ length(unique(sh$id)))
length(unique(sh$id))
length(unique(tm$id))+ length(unique(sh$id))
mean(sh$rms, na.rm=TRUE)
length(unique(sh$id))
length(unique(tm$id))+1  : length(unique(tm$id)) + length(unique(sh$id))
lines(length(unique(tm$id))+1  : length(unique(tm$id)) + length(unique(sh$id)),
rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id))), col="green", lwd=2)
length(length(unique(tm$id))+1  : length(unique(tm$id)) + length(unique(sh$id)))
length(rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id))))
length(unique(tm$id)) + length(unique(sh$id)
length(unique(tm$id)) + length(unique(sh$id))
115-36
lines(length(unique(tm$id))   : length(unique(tm$id)) + length(unique(sh$id)),
rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id))), col="green", lwd=2)
X <- length(unique(tm$id)) : length(unique(tm$id)) + length(unique(sh$id))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
length(unique(tm$id)) : length(unique(tm$id)) + length(unique(sh$id))
unique(tm$id))
length(unique(tm$id))
length(unique(tm$id)) + length(unique(sh$id))
seq(length(unique(tm$id)) : length(unique(tm$id)) + length(unique(sh$id)))
X <- seq(length(unique(tm$id)) : length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
length(X)
X
length(unique(tm$id))
length(unique(tm$id)) + length(unique(sh$id))
dim(tm)
tim(tm)
dim(tm)
tm
length(unique(tm$id)) + length(unique(sh$id))
36:115
length(unique(tm$id)) : length(unique(tm$id)) + length(unique(sh$id))
length(unique(tm$id)) + length(unique(sh$id))
length(unique(tm$id))
length(unique(tm$id)) : length(unique(tm$id)) + length(unique(sh$id))
length(unique(tm$id)) : (length(unique(tm$id)) + length(unique(sh$id)) )
X <-  length(unique(tm$id)) : (length(unique(tm$id)) + length(unique(sh$id)) )
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
length(X)
X <-  length(unique(tm$id)) : (length(unique(tm$id)) + length(unique(sh$id)) )-1
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
length(X)
length(Y)
length(unique(tm$id)) : (length(unique(tm$id)) + length(unique(sh$id)) )
X <-  length(unique(tm$id))+1 : (length(unique(tm$id)) + length(unique(sh$id)) )
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
X
length(unique(tm$id))+1 : (length(unique(tm$id)) + length(unique(sh$id)) )
length(unique(tm$id))+1
(length(unique(tm$id)) + length(unique(sh$id))
)
X <- length(unique(tm$id))+1 : (length(unique(tm$id)) + length(unique(sh$id)))
X
X<-c()
X <- length(unique(tm$id))+1 : (length(unique(tm$id)) + length(unique(sh$id)))
X
length(X)
length(unique(tm$id))
(length(unique(tm$id)) + length(unique(sh$id)))
length(unique(tm$id))  : (length(unique(tm$id)) + length(unique(sh$id)))
X <- length(unique(tm$id))  : (length(unique(tm$id)) + length(unique(sh$id)))
X
length(X)
length(Y)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
X
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
# Plot all ----------------------------------------------------------------
plot(rep(1,length(df[df$id==unique(df$id)[1], "rms"])), df[df$id==unique(df$id)[1], "rms"],
xlim=c(0, length(unique(df$id))), ylim=c(0,1.4),
col= unique(mycolors[ df$id==unique(df$id)[1]]),
pch= unique(mypch[ df$id==unique(df$id)[1]])   , ylab="RELSA score", xlab="Animal index",
bg = "black", cex=1)
for(i in 2:length(unique(df$id))){
points( rep(i,length(df[df$id==unique(df$id)[i], "rms"])), df[df$id==unique(df$id)[i], "rms"],
col= unique(mycolors[ df$id==unique(df$id)[i]]),
pch= unique(mypch[ df$id==unique(df$id)[i]]),
bg = "black", cex=ifelse(unique(mypch[ df$id==unique(df$id)[i]])==18,1.7,1))
}
abline(h=levels$level1, lwd=2, lty=2)
abline(h=levels$level2, lwd=2, lty=2)
abline(h=levels$level3, lwd=2, lty=2)
abline(h=levels$level4, lwd=2, lty=2)
text(100,levels$level1+0.1, levels$level1 )
text(100,levels$level2+0.1, levels$level2 )
text(100,levels$level3+0.1, levels$level3 )
text(100,levels$level4+0.1, levels$level4 )
abline(v=36.5, lwd=1, lty=3)
lines(1:length(unique(tm$id)), rep(median(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
# Plot all ----------------------------------------------------------------
plot(rep(1,length(df[df$id==unique(df$id)[1], "rms"])), df[df$id==unique(df$id)[1], "rms"],
xlim=c(0, length(unique(df$id))), ylim=c(0,1.4),
col= unique(mycolors[ df$id==unique(df$id)[1]]),
pch= unique(mypch[ df$id==unique(df$id)[1]])   , ylab="RELSA score", xlab="Animal index",
bg = "black", cex=1)
for(i in 2:length(unique(df$id))){
points( rep(i,length(df[df$id==unique(df$id)[i], "rms"])), df[df$id==unique(df$id)[i], "rms"],
col= unique(mycolors[ df$id==unique(df$id)[i]]),
pch= unique(mypch[ df$id==unique(df$id)[i]]),
bg = "black", cex=ifelse(unique(mypch[ df$id==unique(df$id)[i]])==18,1.7,1))
}
abline(h=levels$level1, lwd=2, lty=2)
abline(h=levels$level2, lwd=2, lty=2)
abline(h=levels$level3, lwd=2, lty=2)
abline(h=levels$level4, lwd=2, lty=2)
text(100,levels$level1+0.1, levels$level1 )
text(100,levels$level2+0.1, levels$level2 )
text(100,levels$level3+0.1, levels$level3 )
text(100,levels$level4+0.1, levels$level4 )
abline(v=36.5, lwd=1, lty=3)
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
sh$rms>1.2
sh[sh$rms>1.2,]
f <- sh[sh$rms>1.2,]
f <- f[complete.cases(f),]
f
testraw[testraw$id==f$id[1], ]
f
# Find the extreme Shams --------------------------------------------------
f <- sh[sh$rms>1,]
f <- f[complete.cases(f),]
testraw[testraw$id==f$id[1], ]
f
testraw[testraw$id==f$id[1], ]
testraw[testraw$id==f$id[2], ]
f
testraw[testraw$id==f$id[2], ]
f <- sh[sh$rms>1,]
f <- f[complete.cases(f),]
testraw[testraw$id==f$id[3], ]
f
# Find the extreme Shams --------------------------------------------------
f <- sh[sh$rms>1,]
f <- f[complete.cases(f),]
testraw[testraw$id==f$id[4], ]
f
f <- sh[sh$rms>0.9,]
f <- f[complete.cases(f),]
f <- sh[sh$rms>0.9,]
f <- f[complete.cases(f),]
f
f <- sh[sh$rms>0.8,]
f <- f[complete.cases(f),]
f
sh[sh$rms>0.8,]
f <- sh[sh$rms>0.8,]
f <- f[complete.cases(f),]
f
f <- sh[sh$rms>0.7,]
f <- f[complete.cases(f),]
f
testraw[testraw$id==f$id[5], ]
f
testraw[testraw$id==f$id[5], ]
f <- sh[sh$rms>0.7,]
f <- f[complete.cases(f),]
f
testraw[testraw$id==f$id[5], ]
f
unique(testraw$id=="MH_092")
unique(testraw$id)=="MH_092"
----------------------------------------
which(unique(testraw$id)=="MH_092")
# plot single animal ------------------------------------------------------
which(unique(testraw$id)=="MH_092")
animal        <- 54
RELSA         <- relsa(set=testset, bsl, a=animal, drop=c("bw","score"), turnvars=c("hr"))
relsascore    <- as.numeric(unlist(RELSA$relsa$rms))
# show raw data + RELSA
plotset       <- relsa_plot(testset, RELSA, levels=levels, animal=animal, plotvar=NULL, plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2))
f
relsascore
plotset       <- relsa_plot(testset, RELSA, levels=levels, animal=animal, plotvar=NULL, plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2))
# plot single animal ------------------------------------------------------
which(unique(testraw$id)=="MH_092")
animal        <- 54
RELSA         <- relsa(set=testset, bsl, a=animal, drop=c("bw","score"), turnvars=c("hr"))
relsascore    <- as.numeric(unlist(RELSA$relsa$rms))
# show raw data + RELSA
plotset       <- relsa_plot(testset, RELSA, levels=levels, animal=animal, plotvar=NULL, plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2))
# Find the extreme Shams --------------------------------------------------
f <- sh[sh$rms>0.7,]
f <- f[complete.cases(f),]
f
which(unique(testraw$id)=="MH_145")
# plot single animal ------------------------------------------------------
animal        <- which(unique(testraw$id)=="MH_145")
RELSA         <- relsa(set=testset, bsl, a=animal, drop=c("bw","score"), turnvars=c("hr"))
relsascore    <- as.numeric(unlist(RELSA$relsa$rms))
# show raw data + RELSA
plotset       <- relsa_plot(testset, RELSA, levels=levels, animal=animal, plotvar=NULL, plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2))
f <- sh[sh$rms>0.7,]
f <- f[complete.cases(f),]
f
# plot single animal ------------------------------------------------------
animal        <- which(unique(testraw$id)=="TDSS_010")
RELSA         <- relsa(set=testset, bsl, a=animal, drop=c("bw","score"), turnvars=c("hr"))
relsascore    <- as.numeric(unlist(RELSA$relsa$rms))
# show raw data + RELSA
plotset       <- relsa_plot(testset, RELSA, levels=levels, animal=animal, plotvar=NULL, plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2))
# Load Miris Data ---------------------------------------------------------
testraw      <- relsa_load("C:/MHH Bleich/Papers/PostOPPaper/Data/post-op miri.txt"  )
vars         <- names(testraw[,-c(1:4)])
pre_test     <- cbind(testraw[,1:4], testraw[,vars])
testset      <- relsa_norm(pre_test, normthese=c("mgs","bur2h","burON","hr","hrv","temp","act"), ontime=1)
df      <-NULL
profile <- c()
for(i in 1:length(unique(testset$id))){
animal       <- i
R            <- relsa(testset, bsl, a=animal,  drop=c("bw","score"), turnvars=c("hr", "mgs","temp"), relsaNA=NA)$relsa
R$treatment  <- pre_test[pre_test$id==unique(pre_test$id)[animal],"treatment"]
R$condition  <- pre_test[pre_test$id==unique(pre_test$id)[animal],"condition"]
profile[i]   <- max(R$rms, na.rm=TRUE)
df           <- rbind(df, data.frame(id=unique(pre_test$id)[animal], day=R$day,
treatment=R$treatment, condition=R$condition, rms=R$rms))
}
colnames(df)   <- c("id", "day", "treatment","condition", "rms")
# the frame needs some order
tm             <- df[df$treatment=="Transmitter", ]
sh             <- df[df$treatment!="Transmitter", ]
df             <- rbind(tm, sh)
### Some general markers for the plots
mycolors   <- rep(NA, dim(df)[1])
mycolors[(df$condition =="Metamizol") & (df$treatment =="Transmitter")] <- rgb(118/255, 6/255, 154/255 )
mycolors[(df$condition =="Metamizol") & (df$treatment =="Sham")]        <- rgb(222/255, 139/255, 249/255 )
mycolors[(df$condition =="Metamizol") & (df$treatment =="Transmitter")] <- "black"
mycolors[(df$condition =="Metamizol") & (df$treatment =="Sham")]        <- rgb(160/255, 160/255, 164/255)
mypch      <- rep(NA, dim(df)[1])
mypch[(df$condition =="Metamizol") & (df$treatment =="Transmitter")] <- 18
mypch[(df$condition =="Metamizol") & (df$treatment =="Sham")]        <- 5
mypch[(df$condition =="Metamizol") & (df$treatment =="Transmitter")] <- 25
mypch[(df$condition =="Metamizol") & (df$treatment =="Sham")]        <- 6
# Plot all ----------------------------------------------------------------
plot(rep(1,length(df[df$id==unique(df$id)[1], "rms"])), df[df$id==unique(df$id)[1], "rms"],
xlim=c(0, length(unique(df$id))), ylim=c(0,1.4),
col= unique(mycolors[ df$id==unique(df$id)[1]]),
pch= unique(mypch[ df$id==unique(df$id)[1]])   , ylab="RELSA score", xlab="Animal index",
bg = "black", cex=1)
for(i in 2:length(unique(df$id))){
points( rep(i,length(df[df$id==unique(df$id)[i], "rms"])), df[df$id==unique(df$id)[i], "rms"],
col= unique(mycolors[ df$id==unique(df$id)[i]]),
pch= unique(mypch[ df$id==unique(df$id)[i]]),
bg = "black", cex=ifelse(unique(mypch[ df$id==unique(df$id)[i]])==18,1.7,1))
}
abline(h=levels$level1, lwd=2, lty=2)
abline(h=levels$level2, lwd=2, lty=2)
abline(h=levels$level3, lwd=2, lty=2)
abline(h=levels$level4, lwd=2, lty=2)
text(100,levels$level1+0.1, levels$level1 )
text(100,levels$level2+0.1, levels$level2 )
text(100,levels$level3+0.1, levels$level3 )
text(100,levels$level4+0.1, levels$level4 )
abline(v=36.5, lwd=1, lty=3)
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
tm$rms
tm
tm[tm$id==unique(tm$id[i]), ]
max(tm[tm$id==unique(tm$id[i]), ], na.rm=TRUE)
max(tm[tm$id==unique(tm$id[i]), ]$rms, na.rm=TRUE)
mymax      <- c()
for(i in 1:length(unique(tm$id))){
mymax[i] <- max(tm[tm$id==unique(tm$id[i]), ]$rms, na.rm=TRUE)
}
mymax
length(unique(tm$id))
tm[tm$id==unique(tm$id[i]), ]
max(tm[tm$id==unique(tm$id[i]), ]$rms, na.rm=TRUE)
max(tm[tm$id==unique(tm$id[1]), ]$rms, na.rm=TRUE)
max(tm[tm$id==unique(tm$id[4]), ]$rms, na.rm=TRUE)
tm[tm$id==unique(tm$id[i]), ]
tm[tm$id==unique(tm$id[i]), ]
tm[tm$id==unique(tm$id[i]), ]
max(tm[tm$id==unique(tm$id[i]), ]$rms, na.rm=TRUE)
# mean maximum RELSA
mymax      <- c()
for(i in 1:length(unique(tm$id))){
mymax[i] <- max(tm[tm$id==unique(tm$id[i]), ]$rms, na.rm=TRUE)
}
mymax
tm
tm[tm$id==unique(tm$id[1]), ]
tm[tm$id==unique(tm$id[2]), ]
tm[tm$id==unique(tm$id[3]), ]
tm[tm$id==unique(tm$id[4]), ]
sh_max      <- c()
for(i in 1:length(unique(tm$id))){
sh_max[i] <- max(sh[sh$id==unique(sh$id[i]), ]$rms, na.rm=TRUE)
}
sh_max
sh_max      <- c()
for(i in 1:length(unique(sh$id))){
sh_max[i] <- max(sh[sh$id==unique(sh$id[i]), ]$rms, na.rm=TRUE)
}
sh_max
lines(1:length(unique(tm$id)), rep(mean(sh_max, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
# Plot all ----------------------------------------------------------------
plot(rep(1,length(df[df$id==unique(df$id)[1], "rms"])), df[df$id==unique(df$id)[1], "rms"],
xlim=c(0, length(unique(df$id))), ylim=c(0,1.4),
col= unique(mycolors[ df$id==unique(df$id)[1]]),
pch= unique(mypch[ df$id==unique(df$id)[1]])   , ylab="RELSA score", xlab="Animal index",
bg = "black", cex=1)
for(i in 2:length(unique(df$id))){
points( rep(i,length(df[df$id==unique(df$id)[i], "rms"])), df[df$id==unique(df$id)[i], "rms"],
col= unique(mycolors[ df$id==unique(df$id)[i]]),
pch= unique(mypch[ df$id==unique(df$id)[i]]),
bg = "black", cex=ifelse(unique(mypch[ df$id==unique(df$id)[i]])==18,1.7,1))
}
abline(h=levels$level1, lwd=2, lty=2)
abline(h=levels$level2, lwd=2, lty=2)
abline(h=levels$level3, lwd=2, lty=2)
abline(h=levels$level4, lwd=2, lty=2)
text(100,levels$level1+0.1, levels$level1 )
text(100,levels$level2+0.1, levels$level2 )
text(100,levels$level3+0.1, levels$level3 )
text(100,levels$level4+0.1, levels$level4 )
abline(v=36.5, lwd=1, lty=3)
# mean RELSA
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
# mean maximum RELSA
tm_max      <- c()
for(i in 1:length(unique(tm$id))){
tm_max[i] <- max(tm[tm$id==unique(tm$id[i]), ]$rms, na.rm=TRUE)
}
sh_max      <- c()
for(i in 1:length(unique(sh$id))){
sh_max[i] <- max(sh[sh$id==unique(sh$id[i]), ]$rms, na.rm=TRUE)
}
lines(1:length(unique(tm$id)), rep(mean(tm_max, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh_max, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
tm_max      <- c()
for(i in 1:length(unique(tm$id))){
tm_max[i] <- max(tm[tm$id==unique(tm$id[i]), ]$rms, na.rm=TRUE)
}
tm_max
max(tm, na.rm = T)
max(tm$rms, na.rm = T)
length(unique(tm$id))
max(tm[tm$id==unique(tm$id[i]), ]
tm[tm$id==unique(tm$id[i]), ]
tm[tm$id==unique(tm$id[1]), ]
tm[tm$id==unique(tm$id[3]), ]
tm[tm$id==unique(tm$id)[3], ]
# Plot all ----------------------------------------------------------------
plot(rep(1,length(df[df$id==unique(df$id)[1], "rms"])), df[df$id==unique(df$id)[1], "rms"],
xlim=c(0, length(unique(df$id))), ylim=c(0,1.4),
col= unique(mycolors[ df$id==unique(df$id)[1]]),
pch= unique(mypch[ df$id==unique(df$id)[1]])   , ylab="RELSA score", xlab="Animal index",
bg = "black", cex=1)
for(i in 2:length(unique(df$id))){
points( rep(i,length(df[df$id==unique(df$id)[i], "rms"])), df[df$id==unique(df$id)[i], "rms"],
col= unique(mycolors[ df$id==unique(df$id)[i]]),
pch= unique(mypch[ df$id==unique(df$id)[i]]),
bg = "black", cex=ifelse(unique(mypch[ df$id==unique(df$id)[i]])==18,1.7,1))
}
abline(h=levels$level1, lwd=2, lty=2)
abline(h=levels$level2, lwd=2, lty=2)
abline(h=levels$level3, lwd=2, lty=2)
abline(h=levels$level4, lwd=2, lty=2)
text(100,levels$level1+0.1, levels$level1 )
text(100,levels$level2+0.1, levels$level2 )
text(100,levels$level3+0.1, levels$level3 )
text(100,levels$level4+0.1, levels$level4 )
abline(v=36.5, lwd=1, lty=3)
# mean RELSA
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
# mean maximum RELSA
tm_max      <- c()
for(i in 1:length(unique(tm$id))){
tm_max[i] <- max( tm[tm$id==unique(tm$id)[i], ]$rms, na.rm=TRUE)
}
sh_max      <- c()
for(i in 1:length(unique(sh$id))){
sh_max[i] <- max(sh[sh$id==unique(sh$id)[i], ]$rms, na.rm=TRUE)
}
lines(1:length(unique(tm$id)), rep(mean(tm_max, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh_max, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
sh_max
tm_max
plot(tm_max)
# Plot all ----------------------------------------------------------------
plot(rep(1,length(df[df$id==unique(df$id)[1], "rms"])), df[df$id==unique(df$id)[1], "rms"],
xlim=c(0, length(unique(df$id))), ylim=c(0,1.4),
col= unique(mycolors[ df$id==unique(df$id)[1]]),
pch= unique(mypch[ df$id==unique(df$id)[1]])   , ylab="RELSA score", xlab="Animal index",
bg = "black", cex=1)
for(i in 2:length(unique(df$id))){
points( rep(i,length(df[df$id==unique(df$id)[i], "rms"])), df[df$id==unique(df$id)[i], "rms"],
col= unique(mycolors[ df$id==unique(df$id)[i]]),
pch= unique(mypch[ df$id==unique(df$id)[i]]),
bg = "black", cex=ifelse(unique(mypch[ df$id==unique(df$id)[i]])==18,1.7,1))
}
abline(h=levels$level1, lwd=2, lty=2)
abline(h=levels$level2, lwd=2, lty=2)
abline(h=levels$level3, lwd=2, lty=2)
abline(h=levels$level4, lwd=2, lty=2)
text(100,levels$level1+0.1, levels$level1 )
text(100,levels$level2+0.1, levels$level2 )
text(100,levels$level3+0.1, levels$level3 )
text(100,levels$level4+0.1, levels$level4 )
abline(v=36.5, lwd=1, lty=3)
# mean RELSA
lines(1:length(unique(tm$id)), rep(mean(tm$rms, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh$rms, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
# mean maximum RELSA
tm_max      <- c()
for(i in 1:length(unique(tm$id))){
tm_max[i] <- max( tm[tm$id==unique(tm$id)[i], ]$rms, na.rm=TRUE)
}
sh_max      <- c()
for(i in 1:length(unique(sh$id))){
sh_max[i] <- max(sh[sh$id==unique(sh$id)[i], ]$rms, na.rm=TRUE)
}
lines(1:length(unique(tm$id)), rep(mean(tm_max, na.rm=TRUE),length(unique(tm$id))), col="red", lwd=2)
X <- (length(unique(tm$id))+1)  : (length(unique(tm$id)) + length(unique(sh$id)))
Y <- rep( mean(sh_max, na.rm=TRUE), length(unique(sh$id)))
lines(X, Y, col="green", lwd=2)
testraw
tm_max
plotset       <- relsa_plot(testset, RELSA, levels=levels, animal=animal, plotvar=NULL, plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2))
# plot single animal ------------------------------------------------------
animal        <- which(unique(testraw$id)=="MH_005")
RELSA         <- relsa(set=testset, bsl, a=animal, drop=c("bw","score"), turnvars=c("hr"))
relsascore    <- as.numeric(unlist(RELSA$relsa$rms))
# show raw data + RELSA
plotset       <- relsa_plot(testset, RELSA, levels=levels, animal=animal, plotvar=NULL, plotRELSA=TRUE, myylim=c(70,120), myYlim=c(0,2))
abline(h=mean(tm$rms, na.rm=TRUE))
